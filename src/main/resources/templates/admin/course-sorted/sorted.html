<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="stylesheet" type="text/css" href="../../../static/admin/layui/css/layui.css"
          th:href="@{/admin/layui/css/layui.css}"/>
    <link rel="stylesheet" type="text/css" href="../../../static/admin/css/admin.css"
          th:href="@{/admin/css/admin.css}"/>
    <style type="text/css">
        .from-set {
            box-shadow: 3px 3px 3px #888888;
            margin: 10px;
            float: left;
        }
    </style>
</head>
<body>
<div style="position: fixed;right: 20px;top: 10px;width: 100px" class="layui-inline tool-btn">
    <form class="layui-form" th:action="@{/auto-sort/course-sorted}" method="get">
        <input type="number" title="请输入查询条件" th:value="${courseVO!=null}?${courseVO.condition}" name="condition" placeholder="输入..." class="layui-input from-set"
               style="width: 92px;">
        <div class="layui-input-block from-set" style="margin-left: 10px; width: 90px;">
            <select name="conditionType">
                <option value="" selected="">无条件</option>
                <option value="" selected="">无条件</option>
                <optgroup label="ID查询">
                    <option th:each="conditon : ${sortConditions}" th:value="${conditon.id}"
                            th:text="${conditon.value}"
                            th:selected="${courseVO!=null}?''+${#strings.equals(courseVO.conditionType,conditon.id+'')}">
                    </option>
                </optgroup>
            </select>
        </div>
        <div class="layui-input-block from-set" style="margin-left: 10px; width: 90px;">
            <select name="grade">
                <option value="" selected="">年级</option>
                <option value="" selected="">年级</option>
                <optgroup label="选择年级">
                    <option th:each="grade : ${grades}" th:value="${grade.id}"
                            th:text="${grade.value}" th:selected="${courseVO!=null}?${courseVO.grade}==${grade.id}">
                    </option>
                </optgroup>
            </select>
        </div>
        <button class="layui-btn layui-btn-normal from-set" title="按条件查询课表" onclick="shade()">查询课表</button>
    </form>
    <form class="layui-form" th:action="@{/auto-sort/sort}" method="post">
        <button class="layui-btn layui-btn-warm from-set" onclick="shade()">一键排课</button>
    </form>
    <button style="width: 90px" id="btn" class="layui-btn layui-btn-normal from-set">导出excel</button>
</div>
<table border="1" class="table2excel">
    <thead>
    <tr>
        <th width="20"></th>
        <th>星期一</th>
        <th>星期二</th>
        <th>星期三</th>
        <th>星期四</th>
        <th>星期五</th>
        <th>星期六</th>
        <th>星期日</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="i : ${#numbers.sequence(1,week.getTime())}">
        <td th:text="${i}" style="text-align: center"></td>
        <td th:each="j :${#numbers.sequence(1,week.getDay())}" width="200" height="100" style="text-align: center;font-size: 15px">
            <th:block th:each="course:${sortedCourses}">
                <th:block th:each="gra : ${grades}">
                    <th:block th:if="${gra.id == course.grade && (course.courseDay == j && course.courseTime == i)}" >
                        <th:block th:text="${course.courseName}+'-'+${course.teacherName}+'-'+${#strings.concat(gra.value,course.major)}+'-'+${course.className}+'|'+${course.roomNum}"></th:block>
                        <br>
                    </th:block>
                </th:block>
            </th:block>
        </td>
    </tr>
    </tbody>
</table>

<script src="../../../static/admin/layui/layui.js" th:src="@{/admin/layui/layui.js}" type="text/javascript"
        charset="utf-8"></script>
<script src="../../../static/admin/js/common.js" th:src="@{/admin/js/common.js}" type="text/javascript"
        charset="utf-8"></script>
<script type="text/javascript"th:src="@{/webjars/jquery/3.3.1/jquery.js}"></script>
<script type="text/javascript"th:src="@{/admin/js/table2excel.js}"></script>

<script>
    function shade() {
        _index = layer.load(1, {
            content: "<div style='margin-left:-47px;padding-top:44px;width:120px;color:#FFF;text-align: center'>正在排课</div>",
            shade: [0.5, '#000']
        });
    }

    $(function() {
        $("#btn").click(function(){
            $(".table2excel").table2excel({
                exclude: ".noExl",
                name: "Excel Document Name",
                filename: "课表导出",
                exclude_img: true,
                exclude_links: true,
                exclude_inputs: true
            });
        });

    });
</script>
</body>
</html>